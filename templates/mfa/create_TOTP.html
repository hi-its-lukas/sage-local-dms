{% extends "mfa/base.html" %}
{% load mfa %}
{% block title %}Authenticator-App einrichten{% endblock %}

{% block content %}
<div class="mfa-header">
    <div class="mfa-logo">
        <span class="material-icons">phone_android</span>
    </div>
    <h1>Authenticator-App einrichten</h1>
    <p>Scannen Sie den QR-Code mit einer Authenticator-App wie Google Authenticator, Microsoft Authenticator oder Authy.</p>
</div>

{% for error in form.non_field_errors %}
<div class="error-message">
    <span class="material-icons">error_outline</span>
    {{ error }}
</div>
{% endfor %}

<div class="qr-code">
    {{ mfa_data.url|qrcode }}
</div>

<div class="secret-code">
    {{ mfa_data.secret }}
</div>

<p style="text-align: center; color: #5f6368; font-size: 13px; margin-bottom: 24px;">
    Falls der QR-Code nicht funktioniert, geben Sie diesen Code manuell in Ihrer App ein.
</p>

<form method="POST">
    {% csrf_token %}
    <div class="form-group">
        <label for="id_name">Name für diesen Schlüssel</label>
        <input type="text" 
               name="name" 
               id="id_name" 
               placeholder="z.B. Privates Handy, Arbeitshandy"
               value="{{ form.name.value|default:'' }}"
               required>
    </div>
    <div class="form-group">
        <label for="id_code">Bestätigungscode aus der App</label>
        <input type="text" 
               name="code" 
               id="id_code" 
               class="code-input"
               maxlength="6" 
               pattern="[0-9]{6}" 
               inputmode="numeric"
               autocomplete="one-time-code"
               placeholder="000000"
               required>
    </div>
    <button type="submit" class="btn btn-success">
        <span class="material-icons">check</span>
        Bestätigen und speichern
    </button>
</form>

<div class="alternative-links">
    <a href="{% url 'mfa:list' %}">
        <span class="material-icons" style="font-size: 16px; vertical-align: middle;">arrow_back</span>
        Zurück zur Übersicht
    </a>
</div>
{% endblock %}
